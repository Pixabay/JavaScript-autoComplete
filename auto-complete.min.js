var autoComplete=function(){return function(e){if(document.querySelector){var t={selector:0,source:0,minChars:3,delay:150,offsetLeft:0,offsetTop:1,disableVerticalPositioning:!1,cache:1,menuClass:"",renderItem:function(e,t){t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var s=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+e+'">'+e.replace(s,"<b>$1</b>")+"</div>"},onSelect:function(e,t,s){}};for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);for(var o="object"==typeof t.selector?[t.selector]:document.querySelectorAll(t.selector),l=0;l<o.length;l++){var c=o[l];c.sc=document.createElement("div"),c.sc.className="autocomplete-suggestions "+t.menuClass,c.autocompleteAttr=c.getAttribute("autocomplete"),c.setAttribute("autocomplete","off"),c.cache={},c.last_val="",c.selectedByMouse=!1,c.locked=!1,c.updateSC=function(e,s){var o=c.getBoundingClientRect();if(c.sc.style.left=Math.round(o.left+(window.pageXOffset||document.documentElement.scrollLeft)+t.offsetLeft)+"px",t.disableVerticalPositioning||(c.sc.style.top=Math.round(o.bottom+(window.pageYOffset||document.documentElement.scrollTop)+t.offsetTop)+"px"),c.sc.style.width=Math.round(o.right-o.left)+"px",!e&&(t.disableAutoDisplay||c.locked||(c.sc.style.display="block"),c.sc.maxHeight||(c.sc.maxHeight=parseInt((window.getComputedStyle?getComputedStyle(c.sc,null):c.sc.currentStyle).maxHeight)),c.sc.suggestionHeight||(c.sc.suggestionHeight=c.sc.querySelector(".autocomplete-suggestion").offsetHeight),c.sc.suggestionHeight))if(s){var l=c.sc.scrollTop,n=s.getBoundingClientRect().top-c.sc.getBoundingClientRect().top;n+c.sc.suggestionHeight-c.sc.maxHeight>0?c.sc.scrollTop=n+c.sc.suggestionHeight+l-c.sc.maxHeight:n<0&&(c.sc.scrollTop=n+l)}else c.sc.scrollTop=0},u(window,"resize",c.updateSC),c.baseElement=t.placeOnParentElementOfInput?c.parentNode:document.body,c.baseElement.appendChild(c.sc),r("autocomplete-suggestion","mouseleave",function(e){var t=c.sc.querySelector(".autocomplete-suggestion.selected");t&&setTimeout(function(){t.className=t.className.replace("selected",""),c.selectedByMouse=!1},20)},c.sc),r("autocomplete-suggestion","mouseover",function(e){var t=c.sc.querySelector(".autocomplete-suggestion.selected");t&&(t.className=t.className.replace("selected","")),this.className+=" selected",c.selectedByMouse=!0},c.sc),r("autocomplete-suggestion","click",function(e){if(a(this,"autocomplete-suggestion")){var s=this.getAttribute("data-val");c.value=s,c.locked=!0,t.onSelect(e,s,this),c.sc.style.display="none",c.selectedByMouse=!1}},c.sc),c.blurHandler=function(){try{var e=document.querySelector(".autocomplete-suggestions:hover")}catch(t){e=0}e?c!==document.activeElement&&setTimeout(function(){},20):(c.last_val=c.value,c.sc.style.display="none",c.selectedByMouse=!1,setTimeout(function(){c.sc.style.display="none"},350)),c.locked=!1},u(c,"blur",c.blurHandler);var n=function(e){var s=c.value;if(c.cache[s]=e,e.length&&s.length>=t.minChars){for(var o="",l=0;l<e.length;l++)o+=t.renderItem(e[l],s);c.sc.innerHTML=o,c.updateSC(0)}else c.sc.style.display="none"};c.keydownHandler=function(e){var s,o=window.event?e.keyCode:e.which;if((40==o||38==o)&&c.sc.innerHTML)return(l=c.sc.querySelector(".autocomplete-suggestion.selected"))?(s=40==o?l.nextSibling:l.previousSibling)?(l.className=l.className.replace("selected",""),s.className+=" selected",c.value=s.getAttribute("data-val")):(l.className=l.className.replace("selected",""),c.value=c.last_val,s=0):((s=40==o?c.sc.querySelector(".autocomplete-suggestion"):c.sc.childNodes[c.sc.childNodes.length-1]).className+=" selected",c.value=s.getAttribute("data-val")),c.updateSC(0,s),c.selectedByMouse=!1,!1;if(27==o)c.value=c.last_val,c.sc.style.display="none",c.selectedByMouse=!1;else if(13==o||9==o){var l;(l=c.sc.querySelector(".autocomplete-suggestion.selected"))&&"none"!=c.sc.style.display&&!c.selectedByMouse&&(c.locked=!0,t.onSelect(e,l.getAttribute("data-val"),l),setTimeout(function(){c.sc.style.display="none"},20))}},u(c,"keydown",c.keydownHandler),c.keyupHandler=function(e){var s=window.event?e.keyCode:e.which;if(c.selectedByMouse=!1,!s||(s<35||s>40)&&27!=s){var o=c.value;if(o.length>=t.minChars){if(o!=c.last_val){if(c.last_val=o,clearTimeout(c.timer),t.cache){if(o in c.cache)return void n(c.cache[o]);for(var l=1;l<o.length-t.minChars;l++){var a=o.slice(0,o.length-l);if(a in c.cache&&!c.cache[a].length)return void n([])}}c.timer=setTimeout(function(){t.source(o,n)},t.delay)}}else c.last_val=o,c.sc.style.display="none"}},u(c,"keyup",c.keyupHandler),c.focusHandler=function(e){c.last_val="\n",c.keyupHandler(e),c.locked=!1},t.minChars||u(c,"focus",c.focusHandler)}this.destroy=function(){for(var e=0;e<o.length;e++){var t=o[e];i(window,"resize",t.updateSC),i(t,"blur",t.blurHandler),i(t,"focus",t.focusHandler),i(t,"keydown",t.keydownHandler),i(t,"keyup",t.keyupHandler),t.autocompleteAttr?t.setAttribute("autocomplete",t.autocompleteAttr):t.removeAttribute("autocomplete"),t.baseElement.removeChild(t.sc),t=null}},this.unlock=function(){for(var e=0;e<o.length;e++)o[e].locked=!1}}function a(e,t){return e.classList?e.classList.contains(t):new RegExp("\\b"+t+"\\b").test(e.className)}function u(e,t,s){e.attachEvent?e.attachEvent("on"+t,s):e.addEventListener(t,s)}function i(e,t,s){e.detachEvent?e.detachEvent("on"+t,s):e.removeEventListener(t,s)}function r(e,t,s,o){u(o||document,t,function(t){for(var o,l=t.target||t.srcElement;l&&!(o=a(l,e));)l=l.parentElement;o&&s.call(l,t)})}}}();"function"==typeof define&&define.amd?define("autoComplete",function(){return autoComplete}):"undefined"!=typeof module&&module.exports?module.exports=autoComplete:window.autoComplete=autoComplete;
